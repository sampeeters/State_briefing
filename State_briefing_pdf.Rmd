--- 
title: "`r paste0('ANS performance briefing - ', State_curr)`"
author: "EUROCONTROL Performance Review Unit"
date: "`r format(Sys.Date(), '%d/%b/%Y')`"
output:
  bookdown::pdf_document2:
    fig_width: 6.3
    fig_height: 4.7
    fig_caption: true
    highlight: tango
    toc: FALSE
bibliography: "bibliography.bib"
csl: ieee.csl
link-citations: yes
colorlinks: yes
monofont: "Source Code Pro"
monofontoptions: "Scale=0.7"
cover-image: images/logo.png
graphics: yes
header-includes: 
- \usepackage{float}
- \floatplacement{figure}{H} #make every figure with caption = h
urlcolor: blue
subparagraph: yes
editor_options: 
  chunk_output_type: console
---

```{r setup, echo=FALSE, include=FALSE}

# run setup script
source("_common.R")

options(tinytex.verbose = TRUE)
opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, error=FALSE, out.width = "\\textwidth")
panderOptions('table.alignment.default', function(df)
  ifelse(sapply(df, is.numeric), 'right', 'left'))
panderOptions('table.split.table', Inf)
panderOptions('big.mark', ",")
panderOptions('keep.trailing.zeros', TRUE)
panderOptions('round', 4)

```

```{r, echo=FALSE}
# Next paragraph
```

```{r ECTL-logo, fig.align='center'}
include_graphics('images/logo.png', dpi = NA)
```

\newpage
# Preface {-}

This performance briefing has been prepared by the EUROCONTROL Performance Review Unit (PRU) in the interest of the exchange of information.

If you have any questions related to this document or if we can help with any ANS performance related matter, then please do not hesitate to contact us: <pru-support@eurocontrol.int>

The information may be copied in whole or in part providing that the copyright notice and disclaimer are included.

The views expressed herein do not necessarily reflect the official views or policy of EUROCONTROL, which makes no warranty, either implied or express, for the information contained in this document, neither does it assume any legal liability or responsibility for the accuracy, completeness or usefulness of this information.

\newpage
# Key observations {-}

<p style="font-weight:600; font-size:36px">TRAFFIC</p>

- Following the high traffic increase already in 2017 ..

- The strong growth ..

- As a result ..

<p style="font-weight:600; font-size:36px">SAFETY</p>

- No data available

<p style="font-weight:600; font-size:36px">CAPACITY</p>

<p style="font-weight:600; font-size:30px">En-route ATFM delays</p>

- No en-route ATFM delay..

<p style="font-weight:600; font-size:30px">Airport arrival ATFM delays</p>

- No airport arrival ATFM delay..

<p style="font-weight:600; font-size:36px">ENVIRONMENT</p>

<p style="font-weight:600; font-size:30px">Horizontal en-route flight efficiency</p>

- In 2008, Finland..

<p style="font-weight:600; font-size:30px">Vertical en-route flight efficiency</p>



<p style="font-weight:600; font-size:30px">Vertical flight efficiency during climb and descent</p>



<p style="font-weight:600; font-size:36px">COST-EFFECTIVENESS</p>

- ARMATS represents.. see [@pru:ace-report-2015]

- Since ARMATS did not..

- Compared to the..

\newpage

```{=latex}
% Trigger ToC creation in LaTeX
\tableofcontents
```

\newpage

```{=latex}
\listoffigures
```

\newpage
# Institutional arrangements


\newpage
# Traffic characteristics

Sources: NM; STATFOR[@7year-forecast-2019]; PRU ANS Performance Data Portal [@ANS-perf-data-portal]; CRCO Service Unit Dashboard [@service-unit-dashboard]

```{r Tfc-overview, echo=FALSE, fig.cap="Traffic characteristics (IFR flights)", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/Tfc_char_overview.png"))

```

```{r Tfc-values}

Diff_prev_year=filter(Capacity_data, YEAR==1)$Con_fl/filter(Capacity_data, YEAR==curr_year-1)$Con_fl*100
Diff_text=paste0(ifelse(Diff_prev_year>0, "+", ifelse(round(Diff_prev_year, 1)==0 & Diff_prev_year<0, "-", "")), 
                     format(round(Diff_prev_year, 1), nsmall=1), "%")

```
* In `r curr_year-1`, traffic increased by `r paste0(ifelse(Tfc_gr_Prev_year>0, "+", ifelse(round(Tfc_gr_Prev_year, 1)==0 & Tfc_gr_Prev_year<0, "-", "")), format(round(Tfc_gr_Prev_year, 1), nsmall=1), "%")`. Between `r curr_year-6` and `r curr_year-1`, traffic increased by `r format(round(((filter(Index_data, TZ_NAME==paste0(State_curr, " Index (2008)") & YEAR==curr_year-1)$Tot_flights/filter(Index_data, TZ_NAME==paste0(State_curr, " Index (2008)") & YEAR==curr_year-6)$Tot_flights)-1)*100, 1), nsmall=1)`%.
* In the first `r ifelse(curr_month==2, "month", paste0(curr_month-1, " months"))` of `r curr_year`, traffic in `r ifelse(State_curr=="UK", "the UK", State_curr)` increased by `r Diff_text` compared to the same period in `r curr_year-1`
* The largest traffic segment is `r arrange(filter(Tfc_groups, YEAR==curr_year), -Share)$Text[1]` (`r format(round(arrange(filter(Tfc_groups, YEAR==curr_year), -Share)$Share[1], 1), nsmall=1)`%), followed by `r arrange(filter(Tfc_groups, YEAR==curr_year), -Share)$Text[2]` (`r format(round(arrange(filter(Tfc_groups, YEAR==curr_year), -Share)$Share[2], 1), nsmall=1)`%) and `r arrange(filter(Tfc_groups, YEAR==curr_year), -Share)$Text[3]` (`r format(round(arrange(filter(Tfc_groups, YEAR==curr_year), -Share)$Share[3], 1), nsmall=1)`%).

\newpage
# Safety


\newpage
# Capacity

## Air traffic flow management (ATFM) delays

Source: NM, PRU ANS Performance Data Portal [@ANS-perf-data-portal]
         The data in this section is from the PRU ANS performance data portal (data section).  
         It is available at: <http://ansperformance.eu/data/performancearea/>

### En-route ATFM delays

```{r Capacity-overview, echo=FALSE, fig.cap="Traffic evolution and en-route ATFM delay", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/ENR_capacity_overview.png"))

```

```{r AvgENR-ATFM-delay-flight, echo=FALSE, fig.cap="Average en route ATFM delay per flight (EUROCONTROL area)", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/ENR_delay_flight_bar.png"))

```

```{r AvgENR-ATFM-delay-flight-change, echo=FALSE, fig.cap="Year on year change of average en route ATFM delay per flight (EUROCONTROL area)", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/ENR_delay_flight_change_bar.png"))

```


```{r Diff_prev_year_delay-ENR", echo=FALSE}

Diff_prev_year_delay_perc=filter(Capacity_data, YEAR==1)$Tot_ENR_ATFM_delay/filter(Capacity_data, YEAR==curr_year-1)$Tot_ENR_ATFM_delay*100
Text_diff_perc=paste0(ifelse(Diff_prev_year_delay_perc>0, "+", ifelse(round(Diff_prev_year_delay_perc, 1)==0 &
                                                                        Diff_prev_year_delay_perc<0, "-", "")), 
                     format(round(Diff_prev_year_delay_perc, 1), nsmall=1), "%")


```



* In the first `r ifelse(curr_month==2, "month", paste0(curr_month-1, " months"))` of `r curr_year`, `r ifelse(State_curr=="UK", "the UK", State_curr)` accounted for `r format(round(Share_flight_hours_controlled*100, 1), nsmall=1)`% of total controlled flight hours and generated `r format(round(Share_ENR_ATFM_delay*100, 1), nsmall=1)`% of total en-route ATFM delays in the EUROCONTROL area. Overall, `r format(round(Share_ENR_ATFM_delayed_flights*100, 1), nsmall=1)`% of the controlled flights in the respective airspace were delayed by en-route ATFM delays (`r paste0(ifelse(curr_month==1, "Jan)", paste0("Jan-", month.abb[curr_month-1])), " ", curr_year)`).
* Delays `r ifelse(Diff_prev_year_delay_perc>0, "increased", ifelse(Diff_prev_year_delay_perc<0, "decreased", "stayed constant"))` in `r curr_year` (`r Text_diff_perc` vs. `r paste0(ifelse(curr_month==1, "Jan)", paste0("Jan-", month.abb[curr_month-1])), " ", curr_year-1)`) to reach `r format(round(ENR_ATFM_delay_flight, 2), nsmall=2)` minutes per flight.


### Airport arrival ATFM delays

```{r Capacity-overview-APT, echo=FALSE, fig.cap="Traffic evolution of airport arrival ATFM delays", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/APT_capacity_overview.png"))

```

```{r Diff_prev_year_delay-APT", echo=FALSE}

Diff_prev_year_delay_perc=filter(Capacity_data_APT, YEAR==1)$Tot_APT_ATFM_delay/
                                                      filter(Capacity_data_APT, YEAR==curr_year-1)$Tot_APT_ATFM_delay*100
Text_diff_perc=paste0(ifelse(Diff_prev_year_delay_perc>0, "+", ifelse(round(Diff_prev_year_delay_perc, 1)==0 &
                                                                        Diff_prev_year_delay_perc<0, "-", "")), 
                     format(round(Diff_prev_year_delay_perc, 1), nsmall=1), "%")


```

- `r State_curr` accounted for `r format(round(Share_APT_ATFM_delay*100, 1), nsmall=1)`% of all arrival ATFM delay in the EUROCONTROL area (`r paste0(ifelse(curr_month==1, "Jan)", paste0("Jan-", month.abb[curr_month-1])), " ", curr_year)`).
- Overall, `r format(round(Share_APT_ATFM_delayed_arr*100, 1), nsmall=1)`% of the flights arriving at airports in `r ifelse(State_curr=="UK", "the UK", State_curr)` were delayed by arrival ATFM regulations (`r paste0(ifelse(curr_month==1, "Jan)", paste0("Jan-", month.abb[curr_month-1])), " ", curr_year)`). Total arrival ATFM delay `r ifelse(Diff_prev_year_delay_perc>0, paste0("increased by ", Text_diff_perc), ifelse(Diff_prev_year_delay_perc<0, paste0("decreased by ", Text_diff_perc), "stayed constant"))` vs. `r paste0(ifelse(curr_month==1, "Jan", paste0("Jan-", month.abb[curr_month-1])), " ", curr_year-1)`.
- The main share (`r format(round(Top_delay_APT$Share[1]*100, 1), nsmall=1)`%) was generated by `r Top_delay_APT$APT_NAME[1]`, closely followed by `r Top_delay_APT$APT_NAME[2]` accounting for `r format(round(Top_delay_APT$Share[2]*100, 1), nsmall=1)`% of all airport ATFM delay in `r ifelse(State_curr=="UK", "the UK", State_curr)` during the first `r ifelse(curr_month==2, "month", paste0(curr_month-1, " months"))` of `r curr_year`.


\newpage
# Environment

Source: PRU ANS Performance Data Portal 
        The data in this section is from the PRU ANS performance data portal (data section).  
        It is available at: <http://ansperformance.eu/data/performancearea/>

## Horizontal en-route flight efficiency

```{r HFE-overview, echo=FALSE, fig.cap="Horizontal en-route flight efficiency", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/HFE_overview.png"))

```

```{r HFE-results, echo=FALSE}

HFE_actual_state=format(round(filter(HFE_results, ENTITY_NAME==State_curr & YEAR == curr_year & TYPE_MODEL=="CPF")$HFE*100, 1), nsmall=1)
HFE_actual_ECTL=format(round(filter(HFE_results, ENTITY_NAME=="EUROCONTROL Area (PRR)" & YEAR == curr_year & TYPE_MODEL=="CPF")$HFE*100, 1), nsmall=1)

```

- Overall, `r ifelse(State_curr=="UK", "the UK", State_curr)` accounted for `r format(round(Share_add_dist*100, 1), nsmall=1)`% of the total additional distance flown in the EUROCONTROL area `r paste0(ifelse(curr_month==1, "Jan)", paste0("Jan-", month.abb[curr_month-1])), " ", curr_year)`.
- Horizontal en-route flight efficiency (actual trajectory) is `r HFE_actual_state`% which is `r ifelse(HFE_actual_state>HFE_actual_ECTL, "above", ifelse(HFE_actual_state<HFE_actual_ECTL, "below", "equal to"))` the EUROCONTROL area average (`r HFE_actual_ECTL`%).

## Vertical en-route flight efficiency

```{r ENR-VFE-overview, echo=FALSE, fig.cap="Vertical en-route flight efficiency", fig.align='center'}

# include_graphics(paste0(dir, "Figures/", State_curr, "/ENR_VFE_overview.png"))

```

## Vertical flight efficiency during climb & descent

```{r CDO-CCO-overview, echo=FALSE, fig.cap="Vertical flight efficiency during climb and descent", fig.align='center'}

include_graphics(paste0(dir, "Figures/", State_curr, "/CDO_CCO_overview.png"))

```


\newpage
# Cost-effectiveness


\newpage
# Annex 1: Evolution of cost-effectiveness performance (2012-2017)


\newpage
# Annex 2: Network Operations Plan (2018-2019/22)



\newpage
# References


